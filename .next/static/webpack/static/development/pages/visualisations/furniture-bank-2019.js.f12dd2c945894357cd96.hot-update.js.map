{"version":3,"file":"static/webpack/static/development/pages/visualisations/furniture-bank-2019.js.f12dd2c945894357cd96.hot-update.js","sources":["webpack:///./containers/FurnitureBank2019/index.jsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport { Helmet } from \"react-helmet\";\nimport {\n  MainContainer,\n  DashboardContainer,\n  ControlsContainer,\n  ChartsContainer,\n  LogoContainer,\n  MainTitle\n} from \"./styles\";\nimport { ControlContainer } from \"./components\";\nimport { useSelector } from \"react-redux\";\nimport {\n  selectFilteredCoordinates,\n} from \"../../store/furnitureBankReducer/selectors\";\nimport { MapContainer, SocChartsContainer, FamilyContainer, ValueContainer } from \"./styles/styledContainers\";\nimport styled from \"styled-components\";\nimport ReactMapGL from \"react-map-gl\";\nimport { heatMapStyles, HEATMAP_SOURCE_ID } from \"./components/Map/styles\";\nimport _ from \"lodash\";\nimport { Paper } from \"@material-ui/core\";\n\nconst MapPaper = styled(Paper)`\n  height: 100%;\n  width: 100%;\n`\nconst Dashboard = () => {\n  const filteredCoordinates = useSelector(selectFilteredCoordinates);\n  const [initMap, setInitMap] = useState(false);\n  const mapRef = useRef();\n  const viewport = {\n    width: \"100%\",\n    height: \"100%\",\n    latitude: 43.66107,\n    longitude: -79.477015,\n    zoom: 8\n  };\n\n  console.log(_.groupBy(filteredCoordinates, \"postal_code\"));\n\n  const handleMapLoaded = () => {\n    mapRef.current\n      .getMap()\n      .addSource(HEATMAP_SOURCE_ID, {\n        type: \"geojson\",\n        data: makeGeoJSON(filteredCoordinates)\n      });\n    mapRef.current.getMap().addLayer(heatMapStyles);\n    setInitMap(true);\n  };\n\n  useEffect(() => {\n    if (initMap) {\n      mapRef.current\n        .getMap()\n        .getSource(HEATMAP_SOURCE_ID)\n        .setData(makeGeoJSON(filteredCoordinates));\n    }\n  }, [filteredCoordinates, initMap]);\n\n  const makeGeoJSON = data => {\n    if (!data) return undefined;\n    return {\n      type: \"FeatureCollection\",\n      features: data.map(feature => {\n        return {\n          type: \"Feature\",\n          properties: {\n            id: feature.postal_code\n          },\n          geometry: {\n            type: \"Point\",\n            coordinates: feature.coors\n              ? [feature.coors.longitude, feature.coors.latitude, 0]\n              : [0, 0, 0]\n          }\n        };\n      })\n    };\n  };\n\n  return (\n    <>\n      <Helmet>\n        <title>Furniture Bank 2019</title>\n      </Helmet>\n      <MainContainer>\n        <DashboardContainer>\n          <ControlsContainer>\n            <LogoContainer>\n              <img\n                src=\"/static/logos/furnitureBank.svg\"\n                alt=\"furniture bank icon\"\n              />\n            </LogoContainer>\n            <ControlContainer />\n          </ControlsContainer>\n          <ChartsContainer>\n            <SocChartsContainer>\n              <MainTitle\n                gridArea=\"title\"\n              >\n                What is the estimated social impact of your donation?\n              </MainTitle>\n              <MapContainer>\n                  <MapPaper>\n                    <ReactMapGL\n                      ref={mapRef}\n                      mapboxApiAccessToken=\"pk.eyJ1Ijoic3plYW5kciIsImEiOiJjajlpeWxnNHUzbWNiMzNvcnF1ZGUzbG5rIn0.fk33YGLOHSZtT_CMEWoIag\"\n                      {...viewport}\n                      mapStyle=\"mapbox://styles/szeandr/ck1664yzv02iq1crq35ea679o\"\n                      onLoad={handleMapLoaded}\n                    >\n                    </ReactMapGL>\n                  </MapPaper>\n              </MapContainer>\n              <FamilyContainer>\n                  Families\n              </FamilyContainer>\n              <ValueContainer>\n\n              </ValueContainer>\n            </SocChartsContainer>\n          </ChartsContainer>\n        </DashboardContainer>\n      </MainContainer>\n    </>\n  );\n};\nexport default Dashboard;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAQA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AAFA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AAGA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAFA;AALA;AAYA;AAfA;AAiBA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAFA;AAIA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AAAA;;;;A","sourceRoot":""}